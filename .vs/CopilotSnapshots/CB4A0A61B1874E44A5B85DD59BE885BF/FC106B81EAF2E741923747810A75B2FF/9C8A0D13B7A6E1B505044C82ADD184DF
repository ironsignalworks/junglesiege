:root{ --frame-pad:12px; --header-h:64px; --footer-h:84px; }
/* === UI Overhaul: Consistent Font, Ribbons, Cards, Screen-Frame HUD === */

/* Root palette (militarized Diablo vibes): yellows, greys, dark greens */
:root{
  --hud-yellow: #d4b35c;      /* warm brass */
  --hud-yellow-d: #8f6c1b;    /* deep brass */
  --hud-green:  #223321;      /* deep ops green */
  --hud-green-2:#354636;      /* pane background */
  --hud-gray:   #171a1a;      /* frame outer */
  --hud-gray-2: #0f1212;      /* frame inner */
  --hud-line:   #3b3f3f;      /* separator */
  --hud-accent: #c8f26a;      /* highlight pip */
  --hud-danger: #b54646;
  --hud-warning:#c89a2b;
  --hud-info:   #60c0c8;
  --hud-ok:     #6ac86f;
  --hud-shadow: 0 0 0 1px rgba(0,0,0,.6), 0 0 12px rgba(0,0,0,.35) inset;
}

/* Universal text treatment */
.game-root, .cinematic-root, .ui, .hud, #hud, .ui-hud, #ui-hud {
  font-family: var(--military-font) !important;
  letter-spacing: 0.5px;
  text-transform: none;
}

/* Cards, intro boxes, boss intros, generic containers */
.card, .intro-card, .boss-intro, .story-card, .notice, .panel {
  background: linear-gradient(180deg, var(--hud-green-2), var(--hud-green));
  border: 2px solid var(--hud-yellow-d);
  box-shadow: var(--hud-shadow), 0 0 0 3px rgba(212,179,92,.15);
  color: #e8e2d0;
  padding: 14px 16px;
  border-radius: 8px;
}
.card .title, .intro-card .title, .boss-intro .title, .story-card .title {
  color: var(--hud-yellow);
  text-shadow: 0 1px 0 #000;
  font-weight: 700;
}

/* Ribbons (non-overlapping presets) */
.ribbon {
  position: fixed;
  z-index: 99998;
  padding: 8px 12px;
  border-radius: 6px;
  border: 2px solid rgba(0,0,0,.4);
  box-shadow: var(--hud-shadow);
  font-size: 12px;
  max-width: min(42vw, 520px);
  pointer-events: none;
}
.ribbon.warning { background: linear-gradient(180deg,#3a2b12,#231a0b); color: #f9e1a8; border-color: #6c4c12; }
.ribbon.info    { background: linear-gradient(180deg,#0f2326,#0b1719); color: #bfeaf2; border-color: #16444a; }
.ribbon.danger  { background: linear-gradient(180deg,#3a1212,#230b0b); color: #ffd1d1; border-color: #6c1a1a; }
.ribbon.success { background: linear-gradient(180deg,#15331a,#0c1f10); color: #c9f6ce; border-color: #1e5a2a; }

/* Ribbon placement helpers to avoid overlap */
.ribbon.top-left     { top: 14px; left: 14px; }
.ribbon.top-right    { top: 14px; right: 14px; }
.ribbon.bottom-left  { bottom: 14px; left: 14px; }
.ribbon.bottom-right { bottom: 14px; right: 14px; }
.ribbon.stacked-1 { transform: translateY(0); }
.ribbon.stacked-2 { transform: translateY(56px); }
.ribbon.stacked-3 { transform: translateY(112px); }

/* Typography consistency for warnings & text */
.warning-text, .notice-text, .boss-intro p, .story-card p {
  font-size: 12px;
  line-height: 1.6;
  color: #e6e6e6;
}
.warning-strong { color: var(--hud-warning); }
.info-strong { color: var(--hud-info); }
.danger-strong { color: var(--hud-danger); }

/* === Screen-Frame HUD (wraps game canvas) === */
#game-viewport { position: relative; }
#screen-hud {
  position: absolute;
  left: 0; top: 0; width: 100%; height: 100%;
  pointer-events: none;
  z-index: 200;
  box-sizing: border-box;
}

/* Frame corners */
#screen-hud::before{
  content:""; position:absolute; inset:0;
  border:3px solid var(--hud-gray);
  box-shadow:0 0 0 2px var(--hud-yellow-d) inset,0 0 0 6px rgba(200,155,44,.18) inset,0 0 24px rgba(0,0,0,.6);
  border-radius:18px;
}
#screen-hud::after{
  content:""; position:absolute;
  left:var(--frame-pad); right:var(--frame-pad);
  top:calc(var(--frame-pad) + var(--header-h));
  bottom:calc(var(--frame-pad) + var(--footer-h));
  border:2px solid var(--hud-line);
  border-radius:10px;
}

/* Top and bottom bars */
.hud-top, .hud-bottom {
  position: absolute; left: 14px; right: 14px;
  display: flex; align-items: center; justify-content: space-between;
  gap: 12px;
  background: linear-gradient(180deg,var(--hud-gray),var(--hud-gray-2));
  border: 2px solid var(--hud-yellow-d);
  box-shadow: var(--hud-shadow);
  padding: 8px 12px;
  border-radius: 10px;
}
.hud-top { top: 10px; }
.hud-bottom { bottom: 10px; }

/* HUD labels/values */
.hud-label { color: var(--hud-yellow); font-size: 10px; opacity: .9; margin-right: 6px; }
.hud-value { color: #f2f2f2; font-size: 14px; text-shadow: 0 1px 0 #000; }

/* Segments for bottom stats */
.hud-seg { display:flex; align-items:center; gap:6px; padding:4px 8px; background: linear-gradient(180deg,#1a1e1e,#101414); border-radius: 6px; border: 1px solid #2e3434; box-shadow: inset 0 0 0 1px rgba(255,255,255,.03); }

/* HP bar */
.hp-bar { position: relative; width: 160px; height: 10px; background: #2a0f10; border: 1px solid #532527; border-radius: 10px; overflow: hidden; }
.hp-fill { position:absolute; left:0; top:0; bottom:0; width: 50%; background: linear-gradient(90deg,#7b2b2f,#c64a4f); box-shadow: 0 0 10px rgba(181,70,70,.45); }

/* Ammo pips */
.pips { display:flex; gap:4px; }
.pip { width: 8px; height: 10px; border: 1px solid #4a3b1a; background: #2b251a; box-shadow: inset 0 0 0 1px rgba(255,255,255,.05); }
.pip.on { background: var(--hud-yellow); box-shadow: 0 0 8px rgba(212,179,92,.35); }

/* Top info (Round/Sector) */
.hud-top .cluster { display:flex; align-items:center; gap:12px; }
.hud-top .cluster .tag {
  padding: 4px 8px; border-radius: 6px;
  background: linear-gradient(180deg,#202525,#141818);
  border: 1px solid #3b3f3f; box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
  color: #e4e1d7; font-size: 12px;
}
.hud-top .cluster .tag .lbl { color: var(--hud-yellow); margin-right: 6px; font-size: 10px; }

/* Ensure in-canvas HUD is visually minimal to reduce clash (optional) */
canvas + .legacy-bottom-hud { display:none !important; }

/* --- Fixes: start screen overlay priority and canvas centering --- */
#start-screen, .start-screen, #htp, #how-to-play, #overlay, .menu, .main-menu {
  position: relative;
  z-index: 100000; /* above screen-hud */
}
#game-viewport { position: relative; }
#screen-hud {
  position: absolute;
  left: 0; top: 0; width: 100%; height: 100%;
  pointer-events: none;
  z-index: 200;
  box-sizing: border-box;
}
#screen-hud.hidden { display: none !important; }

/* Center canvas and keep it crisp */
body.game-root, .game-root {
  min-height: 100vh;
  display: grid;
  place-items: center;
  background: radial-gradient(1200px 600px at 50% 100%, rgba(25,30,25,0.35), rgba(10,12,10,0.85) 60%), #0b0f0f;
}

/* Ensure any canvas is centered and not stretched */
canvas { display: block; max-width: 100vw; max-height: 100vh; image-rendering: pixelated; }

/* Optional wrapper if present */
#game-viewport {
  position: relative;
  width: min(100vw, calc(100vh * 4/3));
  height: calc(min(100vw, calc(100vh * 4/3)) * 3/4);
}
#game-viewport canvas { width: auto !important; height: auto !important; }

#stage{
  position:absolute;
  left:var(--frame-pad); right:var(--frame-pad);
  top:calc(var(--frame-pad) + var(--header-h));
  bottom:calc(var(--frame-pad) + var(--footer-h));
  overflow:hidden; border-radius:10px; background:#0b0f0f; box-sizing:border-box; z-index:150;
}
#stage canvas{ position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); }

.intro-card, .boss-intro, .story-card, .notice, .panel, .banner, .warning { position:absolute; z-index:400; }
.screen-root, #start-screen, #end-screen, #overlay { position:absolute; inset:0; z-index:350; }

#hud-header, #hud-footer{ position:absolute; left:var(--frame-pad); right:var(--frame-pad); display:flex; align-items:center; gap:12px; z-index:360; }
#hud-header{ top:var(--frame-pad); height:var(--header-h); border-bottom:2px solid var(--hud-line); }
#hud-footer{ bottom:var(--frame-pad); height:var(--footer-h); border-top:2px solid var(--hud-line); }
#hud-header .cluster, #hud-footer .hud-row{ display:flex; gap:16px; align-items:center; }
#hud-footer .hud-row{ width:100%; justify-content:space-between; }
