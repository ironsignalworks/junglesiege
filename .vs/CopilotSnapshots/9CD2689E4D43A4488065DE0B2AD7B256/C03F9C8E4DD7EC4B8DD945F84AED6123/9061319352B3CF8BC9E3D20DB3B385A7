/* Jungle Siege - SIMPLIFIED FUNCTIONAL HUD */
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

/* Variables */
:root {
  --primary-green: #c7ffc7;
  --hud-yellow: #ffc107;
  --military-font: 'Press Start 2P', monospace;
  
  /* HUD COLORS */
  --hud-panel-bg: #1a1a1a;
  --hud-border: #ffc107;
  --health-bg: #1a0a0a;
  --health-fill: #e53e3e;
  --ammo-on: #ffc107;
  --ammo-off: #333333;
  
  /* BOSS COLORS */
  --boss-bg: #0d0d0d;
  --boss-border: #ffc107;
  --boss-name-color: #ffffff;
  --boss-hp-bg: #2a0a0a;
  --boss-hp-fill: #ff6666;
}

/* Global Reset - ENFORCE PRESS START 2P EVERYWHERE */
* {
  box-sizing: border-box;
  font-family: 'Press Start 2P', monospace !important;
}

html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
  background: #000;
  color: var(--primary-green);
  font-family: 'Press Start 2P', monospace !important;
}

/* 4:3 Container */
.screen-container-4x3,
#start-screen,
#game-viewport,
#end-screen {
  position: fixed;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(100vw, calc(100vh * 4 / 3));
  height: calc(min(100vw, calc(100vh * 4 / 3)) * 3 / 4);
  background: #000;
  overflow: hidden;
}

/* Start Screen */
#start-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  border: 4px solid var(--hud-border);
  background-image: url('/assets/images/poster1.png');
  background-size: contain;
  background-position: center;
  background-repeat: no-repeat;
  text-align: center;
}

#start-screen.fade-out {
  opacity: 0;
  pointer-events: none;
}

#start-screen h1 {
  color: var(--hud-yellow);
  font-size: clamp(1.5rem, 6vw, 3.5rem);
  margin: 0.5rem auto;
  text-transform: uppercase;
  text-shadow: 2px 2px 0 #000000;
  font-family: 'Press Start 2P', monospace !important;
}

#start-screen h2 {
  color: var(--primary-green);
  font-size: clamp(0.8rem, 3vw, 1.8rem);
  margin: 0.5rem auto 1.5rem auto;
  text-shadow: 1px 1px 0 #000000;
  font-family: 'Press Start 2P', monospace !important;
}

/* Buttons */
#start-button, #restart-button {
  font-family: 'Press Start 2P', monospace !important;
  font-size: clamp(0.8rem, 2.5vw, 1.1rem);
  text-transform: uppercase;
  width: min(250px, 70%);
  padding: 1em 1.5em;
  cursor: pointer;
  background: #daa520;
  border: 3px solid;
  border-color: #ffeb3b #8b6914 #8b6914 #ffeb3b;
  color: #000;
  margin: 1rem auto 0 auto;
  display: block;
  font-weight: bold;
}

#start-button:hover, #restart-button:hover {
  background: #f4d03f;
  transform: translateY(-1px);
}

#start-button:active, #restart-button:active {
  transform: translateY(1px);
}

/* Game Viewport */
#game-viewport {
  border: 2px solid #333;
  position: relative;
  z-index: 1000;
}

/* Stage */
#stage {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: #000;
}

/* Canvas */
canvas#gameCanvas {
  display: none;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #000;
  z-index: 50;
  image-rendering: pixelated;
  cursor: crosshair;
  touch-action: none;
}

canvas#gameCanvas.active {
  display: block;
}

/* ============ SIMPLIFIED FUNCTIONAL HUD - FORCE VISIBILITY ============ */

/* HUD Container - FORCE VISIBLE */
#screen-hud {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100% !important;
  height: 100% !important;
  z-index: 200 !important;
  pointer-events: none !important;
  opacity: 1 !important;
  display: block !important;
  visibility: visible !important;
  transition: opacity 0.3s ease;
  font-family: 'Press Start 2P', monospace !important;
  /* REMOVED DEBUG BACKGROUND - was interfering with input */
}

#screen-hud.hidden {
  opacity: 0 !important;
  pointer-events: none !important;
  /* Remove display: none to keep HUD visible for debugging */
}

/* HUD Top Bar - Game Stats (double height, boxed centered stats) */
.hud-top {
  position: absolute;
  top: 8px;
  left: 8px;
  right: 8px;
  height: 64px; /* doubled */
  background: var(--hud-panel-bg);
  border: 2px solid var(--hud-border);
  padding: 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  transition: opacity 0.3s ease, transform 0.3s ease;
  font-family: 'Press Start 2P', monospace !important;
}

/* COMPLETELY HIDE top HUD during boss fights */
#screen-hud.boss-mode .hud-top { display: none; }

.hud-top .cluster { display: flex; gap: 12px; align-items: center; }

/* each stat becomes a vertically-centered boxed tile */
.hud-top .tag {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 8px 12px;
  min-width: 120px;
  background: linear-gradient(180deg,#2f2f2f,#111);
  border: 1px solid #333;
  border-radius: 6px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.03);
}

.hud-top .lbl {
  color: var(--hud-yellow) !important;
  font-size: 12px !important;
  text-transform: uppercase;
  text-align: center;
}

.hud-top .val {
  color: var(--primary-green) !important;
  font-size: 18px !important;
  font-weight: bold;
  text-align: center;
}

/* Boss HP bar stays above top HUD and unchanged */
.boss-hp-container { z-index: 400; }

/* HUD Bottom Bar - Player Stats (double height, boxed segments) */
.hud-bottom {
  position: absolute !important;
  bottom: 8px !important;
  left: 8px !important;
  right: 8px !important;
  height: 64px !important; /* doubled */
  background: var(--hud-panel-bg) !important;
  border: 2px solid var(--hud-border) !important;
  padding: 12px 16px !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  gap: 16px !important;
  font-family: 'Press Start 2P', monospace !important;
  opacity: 1 !important;
  visibility: visible !important;
  z-index: 300 !important;
}

.hud-seg {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 8px !important;
  padding: 8px 14px !important;
  min-width: 140px;
  background: linear-gradient(180deg,#2f2f2f,#111) !important;
  border: 1px solid #333 !important;
  border-radius: 6px !important;
}

.hud-label {
  color: var(--hud-yellow) !important;
  font-size: 12px !important;
  text-transform: uppercase;
  text-align: center;
}

.hud-value {
  color: var(--primary-green) !important;
  font-size: 20px !important;
  font-weight: bold;
  text-align: center;
}

/* HP Bar sizing inside boxed segment */
.hp-bar {
  position: relative !important;
  width: 100% !important;
  max-width: 220px !important;
  height: 28px !important;
  background: var(--health-bg) !important;
  border: 1px solid #333 !important;
  display: block !important;
}

.hp-fill {
  position: absolute !important;
  left: 2px !important;
  top: 2px !important;
  bottom: 2px !important;
  background: var(--health-fill) !important;
  transition: width 0.3s ease;
}

/* Ammo pips inside boxed segment */
.pips { display: flex !important; gap: 8px !important; align-items: center !important; }
.pip { width: 12px !important; height: 14px !important; background: var(--ammo-off) !important; border: 1px solid #555 !important; }
.pip.on { background: var(--ammo-on) !important; border-color: var(--hud-border) !important; }

/* Mobile fallback */
@media (max-width: 600px), (max-height: 450px) {
  .hud-top, .hud-bottom { height: 48px !important; padding: 8px 10px !important; }
  .hud-top .tag, .hud-seg { min-width: 80px; padding: 6px 8px; }
  .hud-top .lbl { font-size: 10px !important; }
  .hud-top .val { font-size: 14px !important; }
  .hud-label { font-size: 10px !important; }
  .hud-value { font-size: 16px !important; }
  .hp-bar { height: 20px !important; max-width: 160px !important; }
  .pip { width: 10px !important; height: 10px !important; }
}

/* ============ BOSS HP BAR (50% shorter width) ============ */

.boss-hp-container {
  position: absolute;
  top: 8px;
  left: 25%; /* Center the shorter bar */
  right: 25%; /* Center the shorter bar */
  height: 12px;
  display: none;
  pointer-events: none;
  font-family: 'Press Start 2P', monospace !important;
}

/* Show ONLY boss HP when in boss mode */
#screen-hud.boss-mode .boss-hp-container {
  display: block;
}

.boss-name {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: var(--boss-bg);
  border: 1px solid var(--boss-border);
  border-bottom: none;
  padding: 0px 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 2px rgba(255, 193, 7, 0.3);
  font-family: 'Press Start 2P', monospace !important;
}

.boss-name-text {
  color: var(--boss-name-color);
  font-size: 3px;
  font-weight: bold;
  text-transform: uppercase;
  text-align: center;
  text-shadow: 1px 1px 0 #000000;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-family: 'Press Start 2P', monospace !important;
}

.boss-hp-bar-container {
  position: absolute;
  top: 5px;
  left: 0;
  right: 0;
  height: 7px;
  background: var(--boss-bg);
  border: 1px solid var(--boss-border);
  border-top: none;
  padding: 1px 4px;
  display: flex;
  align-items: center;
  gap: 3px;
  box-shadow: 0 0 2px rgba(255, 193, 7, 0.3);
  font-family: 'Press Start 2P', monospace !important;
}

.boss-hp-label {
  color: var(--hud-yellow);
  font-size: 2px;
  text-transform: uppercase;
  white-space: nowrap;
  font-family: 'Press Start 2P', monospace !important;
}

.boss-hp-bar {
  position: relative;
  flex: 1;
  height: 3px;
  background: var(--boss-hp-bg);
  border: 1px solid #333;
  overflow: hidden;
}

.boss-hp-fill {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: linear-gradient(90deg, var(--boss-hp-fill), #ff4444);
  transition: width 0.3s ease;
  box-shadow: 0 0 1px rgba(255, 102, 102, 0.6);
}

.boss-hp-text {
  color: var(--primary-green);
  font-size: 2px;
  font-weight: bold;
  white-space: nowrap;
  text-shadow: 1px 1px 0 #000000;
  font-family: 'Press Start 2P', monospace !important;
}

/* HUD Bottom Bar - Player Stats (Always visible) - FORCE VISIBLE */
.hud-bottom {
  position: absolute !important;
  bottom: 8px !important;
  left: 8px !important;
  right: 8px !important;
  height: 14px !important; /* compact to match boss bar */
  padding: 2px 8px !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  gap: 12px !important;
  font-family: 'Press Start 2P', monospace !important;

  /* Wolfenstein metal panel */
  background: linear-gradient(180deg,#3b3b3b 0%, #181818 100%) !important;
  border: 2px solid #666 !important;
  border-top-color: #cfcfcf !important;
  border-left-color: #cfcfcf !important;
  border-bottom-color: #222 !important;
  border-right-color: #222 !important;

  box-shadow:
    inset 0 1px 0 rgba(255,255,255,0.06) !important,
    inset 0 -2px 4px rgba(0,0,0,0.6) !important,
    0 3px 8px rgba(0,0,0,0.6) !important;

  opacity: 1 !important;
  visibility: visible !important;
  z-index: 300 !important;
  pointer-events: none;
}

.hud-bottom .hud-seg { gap: 8px; align-items: center; }
.hud-bottom .hud-label { color: #e6c84a !important; font-size: 8px !important; }
.hud-bottom .hud-value { color: var(--primary-green) !important; font-size: 8px !important; font-weight: bold; }

/* HP Bar adjusted to sit nicely within slim panel */
.hp-bar { height: 8px !important; max-width: 140px !important; border: 1px solid #2b2b2b !important; }
.hp-fill { top: 1px !important; bottom: 1px !important; }

.pips { gap: 4px !important; }
.pip { width: 6px !important; height: 8px !important; border: 1px solid #444 !important; }

/* Mobile fallback */
@media (max-width: 600px), (max-height: 450px) {
  .hud-top, .hud-bottom { height: 12px; padding: 1px 6px; }
  .hp-bar { height: 6px; }
  .pip { width: 5px; height: 6px; }
}

/* ============ INTEL POPUP (Remove bottom text) ============ */

.intel-popup {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 60%;
  max-width: 400px;
  background: var(--hud-panel-bg);
  border: 3px solid var(--hud-border);
  padding: 20px;
  z-index: 500;
  display: none;
  font-family: 'Press Start 2P', monospace !important;
}

.intel-popup.show {
  display: block;
}

.intel-title {
  color: var(--hud-yellow);
  font-size: 12px;
  text-transform: uppercase;
  margin-bottom: 12px;
  text-align: center;
  font-family: 'Press Start 2P', monospace !important;
}

.intel-content {
  color: var(--primary-green);
  font-size: 8px;
  line-height: 1.4;
  text-align: left;
  font-family: 'Press Start 2P', monospace !important;
}

/* ============ STORY CARDS (NO GATE TEXT) ============ */

.story-card-panel {
  border: 3px solid var(--hud-border);
  background: var(--hud-panel-bg);
  padding: 16px;
  font-family: 'Press Start 2P', monospace !important;
  position: relative;
}

.story-card-text {
  color: var(--primary-green);
  font-size: 10px;
  line-height: 1.4;
  text-align: left;
  font-family: 'Press Start 2P', monospace !important;
}

.story-card-title {
  color: var(--hud-yellow);
  font-size: 12px;
  font-weight: bold;
  text-transform: uppercase;
  margin-bottom: 12px;
  font-family: 'Press Start 2P', monospace !important;
}

.story-card-prompt {
  color: #999;
  font-size: 8px;
  margin-top: 12px;
  text-align: right;
  font-family: 'Press Start 2P', monospace !important;
}

/* ============ ENHANCED ANTI-OVERLAP NOTIFICATIONS ============ */

/* WARNING OVERLAYS - POP ANIMATION with better spacing */
.warning-overlay {
  position: absolute;
  z-index: 300;
  pointer-events: none;
  font-family: 'Press Start 2P', monospace !important;
  text-transform: uppercase;
  font-size: 12px;
  text-align: center;
  white-space: nowrap;
  animation: warningPop 0.8s ease-out;
  min-width: 100px; /* Minimum width to help with spacing calculations */
  /* Position will be set by JavaScript randomly */
}

@keyframes warningPop {
  0% {
    transform: translate(-50%, -50%) scale(0.1);
    opacity: 0;
  }
  30% {
    transform: translate(-50%, -50%) scale(1.3);
    opacity: 0.8;
  }
  60% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scale(0);
    opacity: 0;
  }
}

/* HUD MERGED OVERRIDE - unified and simplified HUD styling
   This block consolidates all HUD-related styles and overrides any previous
   definitions to ensure consistent look and behavior. It intentionally uses
   higher specificity and !important where necessary so the runtime page picks
   up the unified style without needing to hunt for multiple scattered rules.
*/

#screen-hud {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100% !important;
  height: 100% !important;
  z-index: 400 !important;
  pointer-events: none !important;
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  font-family: 'Press Start 2P', monospace !important;
}

/* Unified panel appearance for both top and bottom HUD */
#screen-hud .hud-top,
#screen-hud .hud-bottom {
  background: linear-gradient(180deg,#2f2f2f,#111) !important;
  border: 1px solid #444 !important; /* neutral border */
  border-radius: 6px !important;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.03), 0 3px 6px rgba(0,0,0,0.6) !important;
  color: var(--primary-green) !important;
  font-family: 'Press Start 2P', monospace !important;
  pointer-events: none !important;
}

/* Top bar specifics */
#screen-hud .hud-top {
  position: absolute !important;
  top: 8px !important;
  left: 8px !important;
  right: 8px !important;
  height: 64px !important;
  padding: 12px 16px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  gap: 12px !important;
}

/* Bottom bar specifics */
#screen-hud .hud-bottom {
  position: absolute !important;
  bottom: 8px !important;
  left: 8px !important;
  right: 8px !important;
  height: 64px !important;
  padding: 12px 16px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  gap: 16px !important;
}

/* Tile (stat) appearance used by both top tags and bottom segments */
#screen-hud .hud-top .tag,
#screen-hud .hud-bottom .hud-seg {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 6px !important;
  padding: 8px 12px !important;
  min-width: 120px !important;
  background: transparent !important; /* tiles appear flush on panel */
  border: none !important;
  border-radius: 4px !important;
  box-shadow: none !important;
}

/* Labels and values centered and scaled for tile layout */
#screen-hud .hud-top .lbl,
#screen-hud .hud-bottom .hud-label,
#screen-hud .hud-top .val,
#screen-hud .hud-bottom .hud-value,
#screen-hud .hud-top .val,
.hud-label, .hud-value {
  text-align: center !important;
  color: var(--primary-green) !important;
}
#screen-hud .hud-top .lbl,
#screen-hud .hud-bottom .hud-label { font-size: 12px !important; text-transform: uppercase !important; }
#screen-hud .hud-top .val,
#screen-hud .hud-bottom .hud-value { font-size: 18px !important; font-weight: 700 !important; }

/* HP bar & pips scaled for boxed layout */
#screen-hud .hp-bar { height: 28px !important; max-width: 220px !important; border: 1px solid #333 !important; background: linear-gradient(180deg,#1d0a0a,#2b0a0a) !important; }
#screen-hud .hp-fill { left: 2px !important; top: 2px !important; bottom: 2px !important; }
#screen-hud .pips { gap: 8px !important; }
#screen-hud .pip { width: 12px !important; height: 14px !important; border: 1px solid #555 !important; }
#screen-hud .pip.on { background: var(--ammo-on) !important; border-color: #888 !important; }

/* Hide any boss-mode top/bottom conflicts: boss HP stays above all */
#screen-hud.boss-mode .hud-top { display: none !important; }
#screen-hud .boss-hp-container { z-index: 500 !important; }

/* Mobile fallback (compact tiles) */
@media (max-width:600px),(max-height:450px) {
  #screen-hud .hud-top, #screen-hud .hud-bottom { height: 48px !important; padding: 8px 10px !important; }
  #screen-hud .hud-top .tag, #screen-hud .hud-bottom .hud-seg { min-width: 80px !important; padding: 6px 8px !important; }
  #screen-hud .hud-top .lbl, #screen-hud .hud-bottom .hud-label { font-size: 10px !important; }
  #screen-hud .hud-top .val, #screen-hud .hud-bottom .hud-value { font-size: 14px !important; }
  #screen-hud .hp-bar { height: 20px !important; max-width: 160px !important; }
  #screen-hud .pip { width: 10px !important; height: 10px !important; }
}

/* FINAL FORCE-OVERRIDE: Ensure HUD is single-line and compact
   This very-specific block is appended last to ensure it overrides any other
   HUD rules. It targets #screen-hud descendants and forces one-line layout,
   small font sizes and compact bar heights with !important on every property.
*/
html body #screen-hud,
html body #screen-hud .hud-top,
html body #screen-hud .hud-bottom,
html body #screen-hud .hud-top .tag,
html body #screen-hud .hud-bottom .hud-seg,
html body #screen-hud .hud-top .lbl,
html body #screen-hud .hud-top .val,
html body #screen-hud .hud-bottom .hud-label,
html body #screen-hud .hud-bottom .hud-value,
html body #screen-hud .hp-bar,
html body #screen-hud .hp-fill,
html body #screen-hud .pips,
html body #screen-hud .pip {
  all: unset !important;
}

html body #screen-hud {
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
  z-index: 9999 !important;
  pointer-events: none !important;
  display: block !important;
  visibility: visible !important;
  font-family: 'Press Start 2P', monospace !important;
}

html body #screen-hud .hud-top,
html body #screen-hud .hud-bottom {
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  background: linear-gradient(180deg,#2f2f2f,#111) !important;
  border: 1px solid #444 !important;
  border-radius: 6px !important;
  box-shadow: none !important;
  color: var(--primary-green) !important;
}

html body #screen-hud .hud-top {
  position: absolute !important;
  top: 6px !important;
  left: 6px !important;
  right: 6px !important;
  height: 16px !important;
  padding: 2px 6px !important;
  gap: 6px !important;
}

html body #screen-hud .hud-bottom {
  position: absolute !important;
  bottom: 6px !important;
  left: 6px !important;
  right: 6px !important;
  height: 16px !important;
  padding: 2px 6px !important;
  gap: 6px !important;
}

html body #screen-hud .hud-top .tag,
html body #screen-hud .hud-bottom .hud-seg {
  display: inline-flex !important;
  flex-direction: row !important;
  align-items: center !important;
  gap: 6px !important;
  padding: 0 6px !important;
  min-width: 48px !important;
  background: transparent !important;
  border: none !important;
  white-space: nowrap !important;
  overflow: hidden !important;
}

html body #screen-hud .hud-top .lbl,
html body #screen-hud .hud-bottom .hud-label {
  font-size: 8px !important;
  line-height: 10px !important;
  text-transform: uppercase !important;
  color: var(--primary-green) !important;
  white-space: nowrap !important;
}

html body #screen-hud .hud-top .val,
html body #screen-hud .hud-bottom .hud-value {
  font-size: 9px !important;
  line-height: 10px !important;
  font-weight: 700 !important;
  color: var(--primary-green) !important;
  white-space: nowrap !important;
}

html body #screen-hud .hp-bar { height: 8px !important; max-width: 120px !important; border: 1px solid #333 !important; }
html body #screen-hud .hp-fill { left: 1px !important; top: 1px !important; bottom: 1px !important; }
html body #screen-hud .pips { gap: 4px !important; }
html body #screen-hud .pip { width: 6px !important; height: 8px !important; border: 1px solid #555 !important; }
html body #screen-hud .pip.on { background: var(--ammo-on) !important; border-color: #888 !important; }

/* Boss priority */
html body #screen-hud.boss-mode .hud-top { display: none !important; }
html body #screen-hud .boss-hp-container { z-index: 10000 !important; }

/* mobile */
@media (max-width:600px),(max-height:450px) {
  html body #screen-hud .hud-top, html body #screen-hud .hud-bottom { height: 14px !important; padding: 1px 4px !important; }
  html body #screen-hud .hud-top .tag, html body #screen-hud .hud-bottom .hud-seg { min-width: 40px !important; padding: 0 4px !important; }
  html body #screen-hud .hud-top .lbl, html body #screen-hud .hud-bottom .hud-label { font-size: 7px !important; }
  html body #screen-hud .hud-top .val, html body #screen-hud .hud-bottom .hud-value { font-size: 8px !important; }
  html body #screen-hud .hp-bar { height: 6px !important; max-width: 100px !important; }
  html body #screen-hud .pip { width: 5px !important; height: 6px !important; }
}
